<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFT Power Fund</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#050810;--bg2:#090d1a;--panel:#0d1426;--border:#1a2a4a;--accent:#00d4ff;--gold:#ffd700;--green:#00ff88;--red:#ff4444;--purple:#9b59ff;--orange:#ff8c00;--text:#c8d8f0;--muted:#4a6080}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'Exo 2',sans-serif;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,212,255,.03) 1px,transparent 1px),linear-gradient(90deg,rgba(0,212,255,.03) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}
.container{max-width:1100px;margin:0 auto;padding:20px;position:relative;z-index:1}
header{text-align:center;padding:40px 0 30px;border-bottom:1px solid var(--border);margin-bottom:30px}
header h1{font-family:'Orbitron',monospace;font-size:clamp(1.5rem,4vw,2.8rem);font-weight:900;background:linear-gradient(135deg,var(--accent),var(--purple),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-transform:uppercase;letter-spacing:4px;margin-bottom:8px}
header p{color:var(--muted);font-family:'Share Tech Mono',monospace;font-size:.85rem;letter-spacing:2px}
.nav{display:flex;gap:8px;margin-bottom:30px;flex-wrap:wrap;justify-content:center}
.nbtn{background:var(--panel);border:1px solid var(--border);color:var(--muted);font-family:'Orbitron',monospace;font-size:.6rem;font-weight:700;padding:8px 12px;cursor:pointer;letter-spacing:1px;transition:all .2s}
.nbtn:hover{border-color:var(--accent);color:var(--accent)}
.nbtn.active{background:rgba(0,212,255,.1);border-color:var(--accent);color:var(--accent)}
.nbtn .num{display:block;font-size:1rem;margin-bottom:2px}
.panel{display:none;animation:fadeIn .3s ease}
.panel.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.card{background:var(--panel);border:1px solid var(--border);padding:24px;margin-bottom:20px;position:relative}
.card::before{content:'';position:absolute;top:0;left:0;width:3px;height:100%;background:var(--accent)}
.card.gold::before{background:var(--gold)}.card.purple::before{background:var(--purple)}.card.green::before{background:var(--green)}.card.orange::before{background:var(--orange)}.card.red::before{background:var(--red)}
.card h2{font-family:'Orbitron',monospace;font-size:.85rem;font-weight:700;letter-spacing:3px;margin-bottom:16px;text-transform:uppercase;color:var(--accent)}
.card.gold h2{color:var(--gold)}.card.purple h2{color:var(--purple)}.card.green h2{color:var(--green)}.card.orange h2{color:var(--orange)}.card.red h2{color:var(--red)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:600px){.grid2{grid-template-columns:1fr}}
.nft-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px;margin:16px 0}
.nft-card{border:1px solid var(--border);padding:16px 12px;text-align:center;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.nft-card:hover{transform:translateY(-3px)}
.nft-card::before{content:'';position:absolute;inset:0;opacity:.06}
.n1{border-color:#555}.n1::before{background:#aaa}
.n2{border-color:#2a7a2a}.n2::before{background:#00ff88}
.n3{border-color:#0055aa}.n3::before{background:#00aaff}
.n4{border-color:#6600aa}.n4::before{background:#9b59ff}
.n5{border-color:#aa4400}.n5::before{background:#ff8c00}
.n6{border-color:#aa8800;box-shadow:0 0 20px rgba(255,215,0,.15)}.n6::before{background:#ffd700}
.nft-icon{font-size:2rem;margin-bottom:8px}
.nft-level{font-family:'Orbitron',monospace;font-size:.55rem;color:var(--muted);letter-spacing:2px}
.nft-power{font-family:'Orbitron',monospace;font-size:1.4rem;font-weight:900;margin:4px 0}
.nft-price{font-family:'Share Tech Mono',monospace;font-size:.75rem}
.n1 .nft-power{color:#aaa}.n2 .nft-power{color:var(--green)}.n3 .nft-power{color:var(--accent)}.n4 .nft-power{color:var(--purple)}.n5 .nft-power{color:var(--orange)}.n6 .nft-power{color:var(--gold)}
.inp-group{margin-bottom:16px}
.inp-group label{display:block;font-family:'Share Tech Mono',monospace;font-size:.72rem;color:var(--muted);letter-spacing:1px;margin-bottom:6px;text-transform:uppercase}
.inp-group input,.inp-group select{width:100%;background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:'Share Tech Mono',monospace;font-size:1rem;padding:10px 14px;outline:none;transition:border-color .2s}
.inp-group input:focus,.inp-group select:focus{border-color:var(--accent)}
.btn{background:linear-gradient(135deg,var(--accent),var(--purple));border:none;color:#000;font-family:'Orbitron',monospace;font-size:.72rem;font-weight:700;letter-spacing:2px;padding:12px 24px;cursor:pointer;text-transform:uppercase;transition:all .2s;width:100%}
.btn:hover:not(:disabled){opacity:.85;transform:translateY(-1px)}
.btn:disabled{cursor:not-allowed;opacity:.4}
.btn.gbtn{background:linear-gradient(135deg,var(--green),var(--accent))}
.btn.obtn{background:linear-gradient(135deg,var(--gold),var(--orange));color:#000}
.btn.rbtn{background:linear-gradient(135deg,var(--red),var(--orange));color:#fff}
.rbox{background:var(--bg2);border:1px solid var(--border);padding:16px;font-family:'Share Tech Mono',monospace}
.rrow{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:.82rem}
.rrow:last-child{border-bottom:none}
.rrow .v{color:var(--accent);font-weight:bold}
.rrow .vg{color:var(--green);font-weight:bold}
.rrow .vgold{color:var(--gold);font-weight:bold}
.rrow .vr{color:var(--red);font-weight:bold}
.hbox{background:rgba(0,212,255,.05);border:1px solid rgba(0,212,255,.2);padding:14px;margin:10px 0;font-size:.85rem;line-height:1.7}
.hbox.gold{background:rgba(255,215,0,.05);border-color:rgba(255,215,0,.2)}
.hbox.green{background:rgba(0,255,136,.05);border-color:rgba(0,255,136,.2)}
.hbox.red{background:rgba(255,68,68,.05);border-color:rgba(255,68,68,.2)}
.hbox.orange{background:rgba(255,140,0,.05);border-color:rgba(255,140,0,.2)}
.flow-step{display:flex;gap:12px;align-items:flex-start;padding:12px;background:var(--bg2);border-left:3px solid var(--accent);margin-bottom:4px}
.flow-step.gold{border-left-color:var(--gold)}.flow-step.green{border-left-color:var(--green)}.flow-step.purple{border-left-color:var(--purple)}.flow-step.orange{border-left-color:var(--orange)}
.flow-num{font-family:'Orbitron',monospace;font-size:1.2rem;font-weight:900;color:var(--accent);min-width:30px}
.flow-step.gold .flow-num{color:var(--gold)}.flow-step.green .flow-num{color:var(--green)}.flow-step.purple .flow-num{color:var(--purple)}.flow-step.orange .flow-num{color:var(--orange)}
.flow-text strong{display:block;font-family:'Orbitron',monospace;font-size:.65rem;letter-spacing:1px;margin-bottom:4px;text-transform:uppercase}
.flow-text p{font-size:.82rem;color:var(--muted);line-height:1.5}
.urow{display:flex;gap:10px;align-items:center;margin-bottom:10px;padding:12px;background:var(--bg2);border:1px solid var(--border)}
.uname{font-family:'Orbitron',monospace;font-size:.65rem;color:var(--accent);width:80px}
.upow{font-family:'Share Tech Mono',monospace;font-size:1rem;color:var(--gold);width:60px;text-align:center}
.ubar{flex:1;height:24px;position:relative;background:var(--bg);border:1px solid var(--border)}
.ubarfill{height:100%;display:flex;align-items:center;padding-left:8px;transition:width .8s ease;font-family:'Share Tech Mono',monospace;font-size:.72rem;color:#000;font-weight:bold}
.urew{font-family:'Share Tech Mono',monospace;font-size:.82rem;color:var(--green);width:80px;text-align:right}
.codeblock{background:#020408;border:1px solid var(--border);padding:20px;font-family:'Share Tech Mono',monospace;font-size:.72rem;line-height:1.8;overflow-x:auto;margin:10px 0}
.codeblock .kw{color:#ff79c6}.codeblock .fn{color:#50fa7b}.codeblock .str{color:#f1fa8c}.codeblock .num{color:#bd93f9}.codeblock .cm{color:#6272a4}.codeblock .tp{color:#8be9fd}
.egg{display:inline-block;font-size:5rem;cursor:pointer;transition:all .3s;filter:drop-shadow(0 0 20px rgba(255,215,0,.3));animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.egg:hover{transform:scale(1.1)}
.egg-result{margin-top:20px;padding:20px;border:1px solid var(--border);background:var(--bg2);display:none;animation:popIn .4s cubic-bezier(.175,.885,.32,1.275)}
@keyframes popIn{from{transform:scale(.5);opacity:0}to{transform:scale(1);opacity:1}}
.egg-result.show{display:block}
.mono{font-family:'Share Tech Mono',monospace;color:var(--accent)}
footer{text-align:center;padding:30px 0;margin-top:30px;border-top:1px solid var(--border);font-family:'Share Tech Mono',monospace;font-size:.7rem;color:var(--muted);letter-spacing:2px}
table{width:100%;border-collapse:collapse;font-family:'Share Tech Mono',monospace;font-size:.75rem}
th{color:var(--muted);font-family:'Orbitron',monospace;font-size:.58rem;letter-spacing:1px;border-bottom:1px solid var(--border);padding:8px;text-align:left}
td{padding:8px;border-bottom:1px solid rgba(255,255,255,.04)}
</style>
</head>
<body>
<div class="container">
<header>
  <h1>NFT Power Fund</h1>
  <p>// SIMULADOR INTERACTIVO COMPLETO — v2.0 //</p>
</header>

<div class="nav">
  <button class="nbtn active" onclick="go(0)"><span class="num">01</span>NIVELES</button>
  <button class="nbtn" onclick="go(1)"><span class="num">02</span>ARQUITECTURA</button>
  <button class="nbtn" onclick="go(2)"><span class="num">03</span>DISTRIBUCIÓN</button>
  <button class="nbtn" onclick="go(3)"><span class="num">04</span>HUEVOS</button>
  <button class="nbtn" onclick="go(4)"><span class="num">05</span>CONTRATO</button>
  <button class="nbtn" onclick="go(5)"><span class="num">06</span>TOKENOMICS</button>
  <button class="nbtn" onclick="go(6)"><span class="num">07</span>PRESTAMOS</button>
  <button class="nbtn" onclick="go(7)"><span class="num">08</span>QUEMA</button>
  <button class="nbtn" onclick="go(8)"><span class="num">09</span>REFERIDOS</button>
  <button class="nbtn" onclick="go(9)"><span class="num">10</span>DASHBOARD</button>
</div>

<!-- TAB 1: NIVELES -->
<div class="panel active" id="p0">
  <div class="card">
    <h2>Los 6 Niveles de NFT</h2>
    <div class="nft-grid">
      <div class="nft-card n1" onclick="showNFT(25,1)"><div class="nft-icon">&#129360;</div><div class="nft-level">NIVEL 1</div><div class="nft-power">25</div><div class="nft-price">$25 USDT</div></div>
      <div class="nft-card n2" onclick="showNFT(50,2)"><div class="nft-icon">&#128154;</div><div class="nft-level">NIVEL 2</div><div class="nft-power">50</div><div class="nft-price">$50 USDT</div></div>
      <div class="nft-card n3" onclick="showNFT(100,3)"><div class="nft-icon">&#128142;</div><div class="nft-level">NIVEL 3</div><div class="nft-power">100</div><div class="nft-price">$100 USDT</div></div>
      <div class="nft-card n4" onclick="showNFT(250,4)"><div class="nft-icon">&#128302;</div><div class="nft-level">NIVEL 4</div><div class="nft-power">250</div><div class="nft-price">$250 USDT</div></div>
      <div class="nft-card n5" onclick="showNFT(500,5)"><div class="nft-icon">&#128293;</div><div class="nft-level">NIVEL 5</div><div class="nft-power">500</div><div class="nft-price">$500 USDT</div></div>
      <div class="nft-card n6" onclick="showNFT(1000,6)"><div class="nft-icon">&#128081;</div><div class="nft-level">NIVEL 6</div><div class="nft-power">1000</div><div class="nft-price">$1,000 USDT</div></div>
    </div>
    <div class="rbox" id="nft-out" style="display:none"><div id="nft-out-inner"></div></div>
  </div>
  <div class="card green">
    <h2>Simulador de Rendimiento</h2>
    <div class="grid2">
      <div>
        <div class="inp-group"><label>Mi Poder (NFT)</label>
          <select id="s-pow"><option value="25">N1 — Poder 25</option><option value="50">N2 — Poder 50</option><option value="100">N3 — Poder 100</option><option value="250">N4 — Poder 250</option><option value="500">N5 — Poder 500</option><option value="1000">N6 — Poder 1000</option></select>
        </div>
        <div class="inp-group"><label>Poder Total del Pool</label><input type="number" id="s-pool" value="5000" min="100"></div>
        <div class="inp-group"><label>Rendimiento Mensual ($)</label><input type="number" id="s-yield" value="2000" min="0"></div>
        <button class="btn gbtn" onclick="calcYield()">CALCULAR GANANCIA</button>
      </div>
      <div class="rbox">
        <div class="rrow"><span style="color:var(--muted)">Mi poder</span><span class="v" id="r-pow">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Poder total pool</span><span class="v" id="r-pool">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Mi % del pool</span><span class="vgold" id="r-pct">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Rendimiento total</span><span class="v" id="r-yld">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">MI GANANCIA</span><span class="vg" id="r-gain" style="font-size:1.1rem">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">ROI mensual</span><span class="vgold" id="r-roi">—</span></div>
      </div>
    </div>
  </div>
</div>

<!-- TAB 2: ARQUITECTURA -->
<div class="panel" id="p1">
  <div class="card">
    <h2>Arquitectura del Sistema</h2>
    <div class="flow-step"><div class="flow-num">01</div><div class="flow-text"><strong>Usuario compra NFT</strong><p>Paga USDT. El smart contract emite el NFT con nivel y poder. Fondos van a la Wallet del Fondo.</p></div></div>
    <div class="flow-step gold"><div class="flow-num">02</div><div class="flow-text"><strong>Usuario stakea su NFT</strong><p>NFT se bloquea en el contrato de staking. Solo NFTs stakeados el dia del snapshot participan en el reparto mensual.</p></div></div>
    <div class="flow-step green"><div class="flow-num">03</div><div class="flow-text"><strong>Tu operas el fondo</strong><p>Con el capital recaudado operas el fondo. Al final del mes depositas las ganancias netas en el contrato de distribucion.</p></div></div>
    <div class="flow-step purple"><div class="flow-num">04</div><div class="flow-text"><strong>Snapshot + Distribucion automatica</strong><p>Dia 1 de cada mes el contrato toma snapshot, calcula porcentaje de cada wallet y distribuye USDT automaticamente.</p></div></div>
    <div class="flow-step orange"><div class="flow-num">05</div><div class="flow-text"><strong>Usuario retira o vende en OpenSea</strong><p>Reclama USDT cuando quiera. Si vende el NFT, lo destakea y lista en OpenSea. El comprador hereda el mismo poder.</p></div></div>
  </div>
  <div class="card purple">
    <h2>Stack Tecnologico</h2>
    <div class="grid2">
      <div>
        <div class="hbox"><strong style="color:var(--purple)">Blockchain: Polygon</strong><br>Fees de $0.001. Compatible OpenSea. USDT disponible.</div>
        <div class="hbox"><strong style="color:var(--accent)">Contratos: Solidity ERC-721</strong><br>NFTs + Staking + Distribucion + Huevos.</div>
      </div>
      <div>
        <div class="hbox"><strong style="color:var(--green)">Aleatoriedad: Chainlink VRF</strong><br>Nadie puede manipular que NFT sale del huevo.</div>
        <div class="hbox"><strong style="color:var(--gold)">Mercado: OpenSea</strong><br>Compatible ERC-721. OpenSea cobra 2.5% al vendedor.</div>
      </div>
    </div>
  </div>
</div>

<!-- TAB 3: DISTRIBUCION -->
<div class="panel" id="p2">
  <div class="card">
    <h2>Simulador de Distribucion Mensual</h2>
    <div class="grid2">
      <div>
        <div class="inp-group"><label>Rendimiento depositado ($)</label><input type="number" id="d-yield" value="5000" min="0"></div>
        <button class="btn" onclick="calcDist()">SIMULAR DISTRIBUCION</button>
      </div>
      <div class="rbox">
        <div class="rrow"><span style="color:var(--muted)">Poder total stakeado</span><span class="v" id="d-totpow">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Rendimiento a repartir</span><span class="vgold" id="d-yld">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Valor por unidad de poder</span><span class="vg" id="d-ppow">—</span></div>
      </div>
    </div>
    <div id="d-users" style="margin-top:16px"></div>
  </div>
</div>

<!-- TAB 4: HUEVOS -->
<div class="panel" id="p3">
  <div class="card gold">
    <h2>Sistema de Huevos de Pascua — Pools Independientes</h2>
    <p style="color:var(--muted);font-size:.82rem;margin-bottom:16px">Cada $1 se fracciona entre los 6 pools. Cada pool acumula independientemente hasta su umbral. La casa nunca pierde.</p>
    <div style="padding:10px;background:var(--bg);border:1px solid var(--border);margin-bottom:14px;font-family:'Share Tech Mono',monospace;font-size:.7rem;display:flex;gap:20px;flex-wrap:wrap">
      <span>Huevos: <span style="color:var(--accent)" id="e-count">0</span></span>
      <span>Recaudado: <span style="color:var(--gold)" id="e-recaud">$0</span></span>
      <span>NFTs entregados: <span style="color:var(--red)" id="e-nfts">$0</span></span>
      <span>Ganancia casa: <span style="color:var(--green)" id="e-gain">$0</span></span>
    </div>
    <div style="font-family:'Share Tech Mono',monospace;font-size:.65rem;color:var(--muted);margin-bottom:12px;padding:8px;background:var(--bg);border:1px solid var(--border)">
      Distribucion por $1: N1=$0.40 &nbsp;|&nbsp; N2=$0.25 &nbsp;|&nbsp; N3=$0.15 &nbsp;|&nbsp; N4=$0.10 &nbsp;|&nbsp; N5=$0.06 &nbsp;|&nbsp; N6=$0.04
    </div>
    <div id="e-bars"></div>
    <div style="text-align:center;padding:20px 0">
      <div style="font-family:'Share Tech Mono',monospace;font-size:.72rem;color:var(--muted);margin-bottom:10px">COSTO: $1 USDT — HAZ CLIC PARA ABRIR</div>
      <div class="egg" id="egg" onclick="openEgg()">&#129370;</div>
      <div class="egg-result" id="e-result">
        <div id="e-icon" style="font-size:3rem;margin-bottom:8px"></div>
        <div id="e-lvl" style="font-family:'Orbitron',monospace;font-size:.72rem;letter-spacing:3px;color:var(--muted)"></div>
        <div id="e-pow" style="font-family:'Orbitron',monospace;font-size:1.8rem;font-weight:900;margin:8px 0"></div>
        <div id="e-desc" style="font-size:.8rem;color:var(--muted)"></div>
      </div>
    </div>
    <div id="e-hist"></div>
  </div>
</div>

<!-- TAB 5: CONTRATO -->
<div class="panel" id="p4">
  <div class="card purple">
    <h2>Contratos Inteligentes — Solidity</h2>
    <div style="font-family:'Orbitron',monospace;font-size:.6rem;letter-spacing:2px;color:var(--purple);margin-bottom:8px">CONTRATO 1 — NFT ERC-721</div>
    <div class="codeblock">
<span class="cm">// ERC-721 con niveles de poder</span>
<span class="kw">contract</span> <span class="tp">PowerNFT</span> <span class="kw">is</span> ERC721 {
  <span class="tp">uint256</span>[] <span class="kw">public</span> levelPower = [<span class="num">0,25,50,100,250,500,1000</span>];
  <span class="tp">uint256</span>[] <span class="kw">public</span> levelPrice = [<span class="num">0,25e6,50e6,100e6,250e6,500e6,1000e6</span>];
  <span class="kw">mapping</span>(<span class="tp">uint256</span> =&gt; <span class="tp">uint8</span>) <span class="kw">public</span> tokenLevel;
  <span class="kw">mapping</span>(<span class="tp">uint256</span> =&gt; <span class="tp">uint256</span>) <span class="kw">public</span> tokenPower;
  <span class="kw">function</span> <span class="fn">mint</span>(<span class="tp">uint8</span> level) <span class="kw">external</span> {
    USDT.transferFrom(msg.sender, fondoWallet, levelPrice[level]);
    <span class="tp">uint256</span> tokenId = ++totalSupply;
    tokenPower[tokenId] = levelPower[level];
    _mint(msg.sender, tokenId);
  }
}</div>
    <div style="font-family:'Orbitron',monospace;font-size:.6rem;letter-spacing:2px;color:var(--green);margin:20px 0 8px">CONTRATO 2 — STAKING + DISTRIBUCION</div>
    <div class="codeblock">
<span class="kw">contract</span> <span class="tp">PowerStaking</span> {
  <span class="kw">mapping</span>(<span class="tp">address</span> =&gt; <span class="tp">uint256</span>) <span class="kw">public</span> stakedPower;
  <span class="tp">uint256</span> <span class="kw">public</span> totalStakedPower;
  <span class="kw">mapping</span>(<span class="tp">address</span> =&gt; <span class="tp">uint256</span>) <span class="kw">public</span> pendingRewards;
  <span class="kw">function</span> <span class="fn">depositYield</span>(<span class="tp">uint256</span> amount) <span class="kw">external onlyOwner</span> {
    <span class="cm">// Distribuye proporcionalmente a todos los stakers</span>
    pendingRewards[staker] += amount * stakedPower[staker] / totalStakedPower;
  }
  <span class="kw">function</span> <span class="fn">claimRewards</span>() <span class="kw">external</span> {
    <span class="tp">uint256</span> reward = pendingRewards[msg.sender];
    pendingRewards[msg.sender] = <span class="num">0</span>;
    USDT.transfer(msg.sender, reward);
  }
}</div>
    <div style="font-family:'Orbitron',monospace;font-size:.6rem;letter-spacing:2px;color:var(--gold);margin:20px 0 8px">CONTRATO 3 — HUEVOS (Chainlink VRF)</div>
    <div class="codeblock">
<span class="kw">contract</span> <span class="tp">EasterEggs</span> {
  <span class="cm">// Pools independientes por nivel</span>
  <span class="tp">uint256</span>[<span class="num">7</span>] <span class="kw">public</span> pools;
  <span class="tp">uint256</span>[<span class="num">7</span>] shares = [<span class="num">0,40,25,15,10,6,4</span>]; <span class="cm">// porcentaje de cada $1</span>
  <span class="tp">uint256</span>[<span class="num">7</span>] thresholds = [<span class="num">0,30e6,62e6,125e6,312e6,625e6,1250e6</span>];
  <span class="kw">function</span> <span class="fn">buyEgg</span>() <span class="kw">external</span> {
    USDT.transferFrom(msg.sender, address(this), <span class="num">1e6</span>);
    <span class="kw">for</span>(<span class="tp">uint8</span> i=<span class="num">1</span>; i&lt;=<span class="num">6</span>; i++) pools[i] += shares[i] * <span class="num">1e4</span>;
    <span class="cm">// Liberar si pool &gt;= threshold</span>
    <span class="kw">for</span>(<span class="tp">uint8</span> i=<span class="num">6</span>; i&gt;=<span class="num">1</span>; i--) {
      <span class="kw">if</span>(pools[i] &gt;= thresholds[i]) { PowerNFT.mint(msg.sender, i); pools[i] -= levelValues[i]; <span class="kw">break</span>; }
    }
  }
}</div>
  </div>
</div>

<!-- TAB 6: TOKENOMICS -->
<div class="panel" id="p5">
  <div class="card orange">
    <h2>Tokenomics y Proyeccion del Fondo</h2>
    <div class="grid2">
      <div>
        <div class="inp-group"><label>Capital total del fondo ($)</label><input type="number" id="t-cap" value="7200" min="100"></div>
        <div class="inp-group"><label>Rendimiento mensual (%)</label><input type="number" id="t-pct" value="15" min="0" max="100"></div>
        <button class="btn obtn" onclick="calcTok()">PROYECTAR FONDO</button>
      </div>
      <div class="rbox" id="t-res" style="display:none">
        <div class="rrow"><span style="color:var(--muted)">Capital del fondo</span><span class="vgold" id="t-rcap">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Rendimiento mensual</span><span class="v" id="t-rpct">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Ganancia bruta</span><span class="vg" id="t-rgross">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Comision proyecto (20%)</span><span class="vgold" id="t-rfee">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Distribuido a holders</span><span class="vg" id="t-rdist">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">APY efectivo holders</span><span class="vgold" id="t-rapy">—</span></div>
      </div>
    </div>
  </div>
</div>

<!-- TAB 7: PRESTAMOS -->
<div class="panel" id="p6">
  <div class="card purple">
    <h2>Sistema de Prestamos NFT</h2>
    <p style="color:var(--muted);font-size:.82rem;margin-bottom:16px">El usuario deposita su NFT como colateral y recibe USDT al instante. LTV 65%, interes 5% mensual. Si no paga en el plazo el NFT queda para el proyecto.</p>
    <div class="grid2">
      <div>
        <div class="inp-group"><label>NFT como colateral</label>
          <select id="l-nft">
            <option value="1">N1 Poder 25 — $25</option>
            <option value="2">N2 Poder 50 — $50</option>
            <option value="3">N3 Poder 100 — $100</option>
            <option value="4">N4 Poder 250 — $250</option>
            <option value="5">N5 Poder 500 — $500</option>
            <option value="6">N6 Poder 1000 — $1,000</option>
          </select>
        </div>
        <div class="inp-group"><label>Plazo (meses)</label>
          <select id="l-months"><option value="1">1 mes</option><option value="2">2 meses</option><option value="3">3 meses (maximo)</option></select>
        </div>
        <button class="btn" style="background:linear-gradient(135deg,var(--purple),var(--accent))" onclick="calcLoan()">CALCULAR PRESTAMO</button>
      </div>
      <div class="rbox">
        <div class="rrow"><span style="color:var(--muted)">Valor del NFT</span><span class="v" id="l-val">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">LTV 65%</span><span class="v" id="l-ltv">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Prestamo maximo</span><span class="vgold" id="l-loan">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Interes mensual 5%</span><span class="v" id="l-int">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Total a devolver</span><span class="v" id="l-tot">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Ganancia proyecto</span><span class="vg" id="l-gain">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Si NO paga — proyecto queda</span><span class="vgold" id="l-def">—</span></div>
      </div>
    </div>
  </div>
  <div class="card">
    <h2>Tabla Completa de Prestamos</h2>
    <div style="overflow-x:auto">
      <table>
        <tr><th>NFT</th><th>VALOR</th><th>PRESTAMO MAX</th><th>INTERES/MES</th><th>3 MESES TOTAL</th><th>GANANCIA 3M</th><th>SI NO PAGA</th></tr>
        <tr><td style="color:#aaa">N1</td><td>$25</td><td style="color:var(--gold)">$16</td><td style="color:var(--green)">$0.80</td><td>$18.40</td><td style="color:var(--green)">$2.40</td><td style="color:var(--accent)">NFT $25 +$9</td></tr>
        <tr><td style="color:#00ff88">N2</td><td>$50</td><td style="color:var(--gold)">$32</td><td style="color:var(--green)">$1.60</td><td>$36.80</td><td style="color:var(--green)">$4.80</td><td style="color:var(--accent)">NFT $50 +$18</td></tr>
        <tr><td style="color:#00d4ff">N3</td><td>$100</td><td style="color:var(--gold)">$65</td><td style="color:var(--green)">$3.25</td><td>$74.75</td><td style="color:var(--green)">$9.75</td><td style="color:var(--accent)">NFT $100 +$35</td></tr>
        <tr><td style="color:#9b59ff">N4</td><td>$250</td><td style="color:var(--gold)">$162</td><td style="color:var(--green)">$8.10</td><td>$186.30</td><td style="color:var(--green)">$24.30</td><td style="color:var(--accent)">NFT $250 +$88</td></tr>
        <tr><td style="color:#ff8c00">N5</td><td>$500</td><td style="color:var(--gold)">$325</td><td style="color:var(--green)">$16.25</td><td>$373.75</td><td style="color:var(--green)">$48.75</td><td style="color:var(--accent)">NFT $500 +$175</td></tr>
        <tr><td style="color:#ffd700">N6</td><td>$1,000</td><td style="color:var(--gold)">$650</td><td style="color:var(--green)">$32.50</td><td>$747.50</td><td style="color:var(--green)">$97.50</td><td style="color:var(--accent)">NFT $1,000 +$350</td></tr>
      </table>
    </div>
    <div class="hbox" style="margin-top:16px">
      <strong style="color:var(--accent)">Reglas:</strong> NFT sale del staking mientras dure el prestamo (sin rewards). Plazo maximo 3 meses. Al vencer, liquidacion automatica. El NFT liquidado puede revenderse.
    </div>
  </div>
</div>

<!-- TAB 8: QUEMA -->
<div class="panel" id="p7">
  <div class="card orange">
    <h2>Fondo de Quema NFT</h2>
    <p style="color:var(--muted);font-size:.82rem;margin-bottom:16px">El usuario quema el NFT permanentemente y recibe USDT por debajo del valor nominal. La quema solo se ejecuta si el fondo tiene liquidez suficiente.</p>

    <!-- SALDO PROMINENTE -->
    <div style="padding:20px;border:2px solid var(--orange);background:rgba(255,140,0,.06);margin-bottom:20px;text-align:center">
      <div style="font-family:'Share Tech Mono',monospace;font-size:.68rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">SALDO DISPONIBLE EN FONDO DE QUEMA</div>
      <div style="font-family:'Orbitron',monospace;font-size:2.5rem;font-weight:900" id="bf-display">$2,500.00</div>
      <div style="font-family:'Share Tech Mono',monospace;font-size:.68rem;color:var(--muted);margin-top:6px">
        Quemas: <span id="bf-count" style="color:var(--orange)">0</span> &nbsp;|&nbsp;
        Pagado: <span id="bf-paid" style="color:var(--red)">$0</span> &nbsp;|&nbsp;
        Retenido: <span id="bf-ret" style="color:var(--green)">$0</span>
      </div>
    </div>

    <!-- RECARGAS -->
    <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;align-items:center">
      <span style="font-family:'Share Tech Mono',monospace;font-size:.7rem;color:var(--muted)">Simular recarga:</span>
      <button onclick="addBurn(100)" style="padding:8px 16px;background:var(--green);color:#000;border:none;font-family:'Orbitron',monospace;font-size:.62rem;font-weight:700;cursor:pointer">+$100</button>
      <button onclick="addBurn(500)" style="padding:8px 16px;background:var(--green);color:#000;border:none;font-family:'Orbitron',monospace;font-size:.62rem;font-weight:700;cursor:pointer">+$500</button>
      <button onclick="addBurn(1000)" style="padding:8px 16px;background:var(--green);color:#000;border:none;font-family:'Orbitron',monospace;font-size:.62rem;font-weight:700;cursor:pointer">+$1,000</button>
    </div>

    <div class="grid2">
      <div>
        <div class="inp-group"><label>NFT a quemar</label>
          <select id="b-nft" onchange="prevBurn()">
            <option value="1">N1 Poder 25 — $25</option>
            <option value="2">N2 Poder 50 — $50</option>
            <option value="3">N3 Poder 100 — $100</option>
            <option value="4">N4 Poder 250 — $250</option>
            <option value="5">N5 Poder 500 — $500</option>
            <option value="6">N6 Poder 1000 — $1,000</option>
          </select>
        </div>
        <div id="b-prev" style="background:var(--bg2);border:1px solid var(--border);padding:14px;margin-bottom:14px;font-family:'Share Tech Mono',monospace;font-size:.8rem">Selecciona un NFT</div>
        <button class="btn rbtn" id="b-btn" onclick="doBurn()">QUEMAR NFT</button>
      </div>
      <div>
        <div class="rbox">
          <div style="font-family:'Orbitron',monospace;font-size:.58rem;color:var(--orange);letter-spacing:2px;margin-bottom:10px">TASAS DE QUEMA</div>
          <div class="rrow"><span style="color:#aaa">N1 $25</span><span>70% &#8594; <span style="color:var(--green)">$17.50</span> usuario / <span style="color:var(--orange)">$7.50</span> fondo</span></div>
          <div class="rrow"><span style="color:#00ff88">N2 $50</span><span>70% &#8594; <span style="color:var(--green)">$35</span> / <span style="color:var(--orange)">$15</span></span></div>
          <div class="rrow"><span style="color:#00d4ff">N3 $100</span><span>72% &#8594; <span style="color:var(--green)">$72</span> / <span style="color:var(--orange)">$28</span></span></div>
          <div class="rrow"><span style="color:#9b59ff">N4 $250</span><span>74% &#8594; <span style="color:var(--green)">$185</span> / <span style="color:var(--orange)">$65</span></span></div>
          <div class="rrow"><span style="color:#ff8c00">N5 $500</span><span>75% &#8594; <span style="color:var(--green)">$375</span> / <span style="color:var(--orange)">$125</span></span></div>
          <div class="rrow"><span style="color:#ffd700">N6 $1,000</span><span>75% &#8594; <span style="color:var(--green)">$750</span> / <span style="color:var(--orange)">$250</span></span></div>
        </div>
      </div>
    </div>
    <div id="b-hist" style="margin-top:16px"></div>
  </div>
  <div class="card">
    <h2>Alimentacion del Fondo de Quema</h2>
    <div class="grid2">
      <div class="hbox green"><strong style="color:var(--green)">Fuentes automaticas:</strong><br><br>10% de cada NFT vendido directo<br>20% del margen de los Huevos<br>30% de los intereses de prestamos<br>100% del margen retenido en quemas</div>
      <div class="hbox red"><strong style="color:var(--red)">Protecciones:</strong><br><br>Tope diario: max $500 en quemas<br>Minimo operativo: $500 reservados<br>Si saldo menor al valor NFT: bloqueado<br>Saldo visible publicamente en tiempo real</div>
    </div>
  </div>
</div>


<!-- TAB 9: REFERIDOS -->
<div class="panel" id="p8">
  <div class="card purple">
    <h2>Sistema de Referidos — SBT + 3 Niveles</h2>
    <p style="color:var(--muted);font-size:.82rem;margin-bottom:16px">
      Cada usuario recibe un SBT (Soulbound Token) al registrarse. La comision se paga al instante
      solo en compras directas de NFT. 3 niveles: 5% nivel 1, 2% nivel 2, 1% nivel 3.
    </p>

    <!-- FLUJO VISUAL -->
    <div style="background:var(--bg);border:1px solid var(--border);padding:16px;margin-bottom:20px;font-family:Share Tech Mono,monospace;font-size:.75rem">
      <div style="font-family:Orbitron,monospace;font-size:.6rem;color:var(--purple);letter-spacing:2px;margin-bottom:12px">FLUJO DE COMISIONES — EJEMPLO N3 $100</div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <div style="display:flex;align-items:center;gap:10px;padding:8px;background:rgba(155,89,255,.08);border-left:2px solid var(--purple)">
          <span style="font-size:1.2rem">&#128081;</span>
          <div><div style="color:var(--muted);font-size:.62rem">USUARIO A — refiere a B</div><div style="color:var(--purple)">Gana 1% = <span style="color:var(--green)">$1.00</span> por cada compra que haga alguien en su red nivel 3</div></div>
        </div>
        <div style="text-align:center;color:var(--muted);font-size:.8rem">&#8595;</div>
        <div style="display:flex;align-items:center;gap:10px;padding:8px;background:rgba(0,212,255,.08);border-left:2px solid var(--accent)">
          <span style="font-size:1.2rem">&#128293;</span>
          <div><div style="color:var(--muted);font-size:.62rem">USUARIO B — refiere a C</div><div style="color:var(--accent)">Gana 2% = <span style="color:var(--green)">$2.00</span> por cada compra que haga alguien en su red nivel 2</div></div>
        </div>
        <div style="text-align:center;color:var(--muted);font-size:.8rem">&#8595;</div>
        <div style="display:flex;align-items:center;gap:10px;padding:8px;background:rgba(0,255,136,.08);border-left:2px solid var(--green)">
          <span style="font-size:1.2rem">&#128154;</span>
          <div><div style="color:var(--muted);font-size:.62rem">USUARIO C — COMPRA NFT N3 $100</div><div style="color:var(--green)">Paga $100 → <span style="color:var(--gold)">$93</span> al fondo · <span style="color:var(--green)">$5</span> a B · <span style="color:var(--accent)">$2</span> a A · <span style="color:var(--purple)">$1</span> a quien refirio a A</div></div>
        </div>
      </div>
    </div>

    <!-- CALCULADORA -->
    <div class="grid2">
      <div>
        <div class="inp-group"><label>NFT comprado por el referido</label>
          <select id="ref-nft" onchange="calcRef()">
            <option value="25">N1 — $25</option>
            <option value="50">N2 — $50</option>
            <option value="100" selected>N3 — $100</option>
            <option value="250">N4 — $250</option>
            <option value="500">N5 — $500</option>
            <option value="1000">N6 — $1,000</option>
          </select>
        </div>
        <div class="inp-group"><label>Cuantos referidos directos tienes (nivel 1)</label>
          <input type="number" id="ref-n1" value="5" min="0" onchange="calcRef()">
        </div>
        <div class="inp-group"><label>Referidos de tus referidos (nivel 2)</label>
          <input type="number" id="ref-n2" value="10" min="0" onchange="calcRef()">
        </div>
        <div class="inp-group"><label>Referidos de nivel 3</label>
          <input type="number" id="ref-n3" value="20" min="0" onchange="calcRef()">
        </div>
        <div style="font-family:Share Tech Mono,monospace;font-size:.65rem;color:var(--muted);padding:8px;background:var(--bg);border:1px solid var(--border)">
          * Calcula si todos compran el mismo nivel de NFT. En la realidad la red compra niveles mixtos.
        </div>
      </div>
      <div class="rbox">
        <div style="font-family:Orbitron,monospace;font-size:.6rem;color:var(--purple);letter-spacing:2px;margin-bottom:10px">TUS COMISIONES</div>
        <div class="rrow"><span style="color:var(--muted)">NFT precio</span><span class="v" id="rc-price">$100</span></div>
        <div class="rrow"><span style="color:var(--muted)">Comision nivel 1 (5%)</span><span class="vg" id="rc-c1">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Tus referidos N1</span><span class="v" id="rc-n1">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Ganancia nivel 1</span><span class="vg" id="rc-g1">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Comision nivel 2 (2%)</span><span class="v" id="rc-c2">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Referidos N2</span><span class="v" id="rc-n2">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Ganancia nivel 2</span><span class="vg" id="rc-g2">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Comision nivel 3 (1%)</span><span class="v" id="rc-c3">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Referidos N3</span><span class="v" id="rc-n3">—</span></div>
        <div class="rrow"><span style="color:var(--muted)">Ganancia nivel 3</span><span class="vg" id="rc-g3">—</span></div>
        <div style="border-top:1px solid var(--border);margin-top:8px;padding-top:8px">
          <div class="rrow"><span style="color:var(--muted)">TOTAL COMISIONES</span><span class="vgold" id="rc-tot" style="font-size:1.2rem">—</span></div>
          <div class="rrow"><span style="color:var(--muted)">Capital al fondo (por compra)</span><span class="v" id="rc-fund">—</span></div>
          <div class="rrow"><span style="color:var(--muted)">% que va al fondo</span><span class="vg" id="rc-pct">—</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- SBT INFO -->
  <div class="card">
    <h2>Como Funciona el SBT (Soulbound Token)</h2>
    <div class="grid2">
      <div>
        <div class="hbox">
          <strong style="color:var(--accent)">Que es un SBT:</strong><br><br>
          Un NFT especial NO transferible. Esta atado a tu identidad, no a tu wallet.
          Si cambias de wallet, vinculas la nueva wallet al mismo SBT y tu red de referidos
          se mantiene intacta. El gas del mint lo paga el proyecto.
        </div>
        <div class="hbox gold">
          <strong style="color:var(--gold)">Datos que contiene:</strong><br><br>
          ID unico · Codigo REF personal · Wallet actual · Quien te refirio ·
          Fecha de registro · Total comisiones ganadas
        </div>
      </div>
      <div>
        <div class="hbox green">
          <strong style="color:var(--green)">Cambio de wallet:</strong><br><br>
          1. Vas a tu perfil en la plataforma<br>
          2. Firmas con tu wallet antigua (prueba de propiedad)<br>
          3. El contrato actualiza el SBT con tu nueva wallet<br>
          4. Tu red y comisiones siguen igual
        </div>
        <div class="hbox red">
          <strong style="color:var(--red)">Anti-fraude:</strong><br><br>
          No auto-referido · Minimo 24h entre registro y primera compra ·
          Compra minima $25 para generar comision ·
          Maximo $30 de comision por transaccion en N6
        </div>
      </div>
    </div>
  </div>

  <!-- SIMULADOR DE RED -->
  <div class="card green">
    <h2>Simulador de Red de Referidos</h2>
    <p style="color:var(--muted);font-size:.82rem;margin-bottom:16px">
      Construye tu red y ve cuanto generaria en comisiones si todos compran un NFT.
    </p>
    <div id="ref-tree" style="font-family:Share Tech Mono,monospace;font-size:.75rem"></div>
    <div style="display:flex;gap:10px;margin-top:16px;flex-wrap:wrap">
      <button onclick="addRefNode(1)" style="padding:8px 14px;background:var(--green);color:#000;border:none;font-family:Orbitron,monospace;font-size:.6rem;font-weight:700;cursor:pointer">+ NIVEL 1</button>
      <button onclick="addRefNode(2)" style="padding:8px 14px;background:var(--accent);color:#000;border:none;font-family:Orbitron,monospace;font-size:.6rem;font-weight:700;cursor:pointer">+ NIVEL 2</button>
      <button onclick="addRefNode(3)" style="padding:8px 14px;background:var(--purple);color:#fff;border:none;font-family:Orbitron,monospace;font-size:.6rem;font-weight:700;cursor:pointer">+ NIVEL 3</button>
      <button onclick="resetRef()" style="padding:8px 14px;background:var(--red);color:#fff;border:none;font-family:Orbitron,monospace;font-size:.6rem;font-weight:700;cursor:pointer">RESET</button>
      <div style="font-family:Share Tech Mono,monospace;font-size:.7rem;color:var(--muted);align-self:center">
        NFT que compran: <select id="ref-tree-nft" onchange="renderRefTree()" style="background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:Share Tech Mono,monospace;padding:4px">
          <option value="25">N1 $25</option><option value="50">N2 $50</option>
          <option value="100" selected>N3 $100</option><option value="250">N4 $250</option>
          <option value="500">N5 $500</option><option value="1000">N6 $1,000</option>
        </select>
      </div>
    </div>
    <div class="rbox" id="ref-tree-total" style="margin-top:14px;display:none">
      <div class="rrow"><span style="color:var(--muted)">Total red</span><span class="v" id="rtt-count">—</span></div>
      <div class="rrow"><span style="color:var(--muted)">Comisiones nivel 1</span><span class="vg" id="rtt-c1">—</span></div>
      <div class="rrow"><span style="color:var(--muted)">Comisiones nivel 2</span><span class="vg" id="rtt-c2">—</span></div>
      <div class="rrow"><span style="color:var(--muted)">Comisiones nivel 3</span><span class="vg" id="rtt-c3">—</span></div>
      <div class="rrow"><span style="color:var(--muted)">TOTAL COMISIONES</span><span class="vgold" id="rtt-tot" style="font-size:1.1rem">—</span></div>
    </div>
  </div>
</div>


<!-- TAB 10: DASHBOARD HISTORICO -->
<div class="panel" id="p9">

  <!-- HEADER STATS -->
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-bottom:20px">
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">TOTAL STAKERS</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900;color:var(--accent)" id="dh-stakers">0</div>
    </div>
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">NFTs EN STAKING</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900;color:var(--purple)" id="dh-nfts">0</div>
    </div>
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">PODER TOTAL POOL</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900;color:var(--gold)" id="dh-power">0</div>
    </div>
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">CAPITAL GESTIONADO</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900;color:var(--green)" id="dh-capital">$0</div>
    </div>
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">ULTIMO DEPOSITO</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900;color:var(--orange)" id="dh-lastdep">$0</div>
    </div>
    <div style="background:var(--panel);border:1px solid var(--border);padding:18px;text-align:center">
      <div style="font-family:Share Tech Mono,monospace;font-size:.62rem;color:var(--muted);letter-spacing:2px;margin-bottom:6px">RENTABILIDAD MEDIA</div>
      <div style="font-family:Orbitron,monospace;font-size:2rem;font-weight:900" id="dh-avg">0%</div>
    </div>
  </div>

  <!-- HISTORIAL DE DEPOSITOS -->
  <div class="card gold">
    <h2>Historial de Depositos Mensuales</h2>
    <p style="color:var(--muted);font-size:.8rem;margin-bottom:16px">
      Cada mes el proyecto deposita lo que el fondo genero realmente. La rentabilidad media se calcula
      sobre el valor nominal total de NFTs en circulacion vs lo depositado.
    </p>

    <!-- SIMULAR DEPOSITO -->
    <div style="background:var(--bg);border:1px solid var(--border);padding:16px;margin-bottom:20px">
      <div style="font-family:Orbitron,monospace;font-size:.65rem;color:var(--gold);letter-spacing:2px;margin-bottom:12px">SIMULAR DEPOSITO MENSUAL</div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:10px;align-items:end;flex-wrap:wrap">
        <div class="inp-group" style="margin:0">
          <label>Mes</label>
          <select id="dh-mes" style="background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:Share Tech Mono,monospace;padding:10px;width:100%">
            <option>Enero 2025</option><option>Febrero 2025</option><option>Marzo 2025</option>
            <option>Abril 2025</option><option>Mayo 2025</option><option>Junio 2025</option>
            <option>Julio 2025</option><option>Agosto 2025</option><option>Septiembre 2025</option>
            <option>Octubre 2025</option><option>Noviembre 2025</option><option>Diciembre 2025</option>
          </select>
        </div>
        <div class="inp-group" style="margin:0">
          <label>Monto depositado ($)</label>
          <input type="number" id="dh-dep" value="350" min="0" style="background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:Share Tech Mono,monospace;padding:10px;width:100%">
        </div>
        <div class="inp-group" style="margin:0">
          <label>Capital gestionado ese mes ($)</label>
          <input type="number" id="dh-cap-mes" value="10000" min="0" style="background:var(--bg2);border:1px solid var(--border);color:var(--text);font-family:Share Tech Mono,monospace;padding:10px;width:100%">
        </div>
        <button onclick="addDeposit()" style="background:linear-gradient(135deg,var(--gold),var(--orange));border:none;color:#000;font-family:Orbitron,monospace;font-size:.65rem;font-weight:700;padding:10px 16px;cursor:pointer;white-space:nowrap">+ AGREGAR</button>
      </div>
    </div>

    <!-- TABLA HISTORICA -->
    <div style="overflow-x:auto">
      <table>
        <tr>
          <th>MES</th>
          <th>CAPITAL GESTIONADO</th>
          <th>DEPOSITO REAL</th>
          <th>RENDIMIENTO %</th>
          <th>STAKERS</th>
          <th>PODER TOTAL</th>
          <th>VALOR NOMINAL NFTs</th>
          <th>RENT. MEDIA/HOLDER</th>
        </tr>
        <tbody id="dh-table-body">
          <tr><td colspan="8" style="text-align:center;color:var(--muted);padding:20px">Agrega el primer deposito mensual</td></tr>
        </tbody>
      </table>
    </div>

    <!-- GRAFICA DE BARRAS -->
    <div style="margin-top:20px" id="dh-chart-wrap" style="display:none">
      <div style="font-family:Orbitron,monospace;font-size:.62rem;color:var(--gold);letter-spacing:2px;margin-bottom:10px">RENDIMIENTO MENSUAL %</div>
      <div id="dh-chart" style="display:flex;gap:6px;align-items:flex-end;height:120px;background:var(--bg);border:1px solid var(--border);padding:10px"></div>
      <div id="dh-chart-labels" style="display:flex;gap:6px;margin-top:4px;font-family:Share Tech Mono,monospace;font-size:.55rem;color:var(--muted)"></div>
    </div>
  </div>

  <!-- CONFIGURAR EL POOL -->
  <div class="card">
    <h2>Configurar Estado del Pool</h2>
    <p style="color:var(--muted);font-size:.8rem;margin-bottom:16px">Define cuantos NFT de cada nivel estan stakeados para calcular el valor nominal total y la rentabilidad media real.</p>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-bottom:16px">
      <div style="background:var(--bg2);border:1px solid #555;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#aaa;margin-bottom:6px">N1 $25</div>
        <input type="number" id="pool-n1" value="20" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #555;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
      <div style="background:var(--bg2);border:1px solid #2a7a2a;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#00ff88;margin-bottom:6px">N2 $50</div>
        <input type="number" id="pool-n2" value="15" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #2a7a2a;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
      <div style="background:var(--bg2);border:1px solid #0055aa;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#00d4ff;margin-bottom:6px">N3 $100</div>
        <input type="number" id="pool-n3" value="10" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #0055aa;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
      <div style="background:var(--bg2);border:1px solid #6600aa;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#9b59ff;margin-bottom:6px">N4 $250</div>
        <input type="number" id="pool-n4" value="5" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #6600aa;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
      <div style="background:var(--bg2);border:1px solid #aa4400;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#ff8c00;margin-bottom:6px">N5 $500</div>
        <input type="number" id="pool-n5" value="3" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #aa4400;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
      <div style="background:var(--bg2);border:1px solid #aa8800;padding:12px;text-align:center">
        <div style="font-family:Orbitron,monospace;font-size:.58rem;color:#ffd700;margin-bottom:6px">N6 $1000</div>
        <input type="number" id="pool-n6" value="1" min="0" onchange="updatePool()" style="width:100%;background:var(--bg);border:1px solid #aa8800;color:var(--text);font-family:Share Tech Mono,monospace;padding:6px;text-align:center;font-size:1rem">
        <div style="font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);margin-top:4px">NFTs</div>
      </div>
    </div>
    <div class="rbox" id="pool-summary">
      <div class="rrow"><span style="color:var(--muted)">Total NFTs stakeados</span><span class="v" id="ps-nfts">54</span></div>
      <div class="rrow"><span style="color:var(--muted)">Poder total del pool</span><span class="vgold" id="ps-power">0</span></div>
      <div class="rrow"><span style="color:var(--muted)">Valor nominal total NFTs</span><span class="vg" id="ps-nominal">$0</span></div>
      <div class="rrow"><span style="color:var(--muted)">Capital estimado en fondo</span><span class="vg" id="ps-capital">$0</span></div>
      <div class="rrow"><span style="color:var(--muted)">Si depositas $350 este mes</span><span class="vgold" id="ps-example">= X% de rentabilidad media</span></div>
    </div>
  </div>
</div>

<footer>// NFT POWER FUND SIMULATOR v2.0 — ARQUITECTURA TECNICA COMPLETA //</footer>
</div>

<script>
// ---- NAV ----
function go(i) {
  document.querySelectorAll('.panel').forEach(function(p,idx){ p.classList.toggle('active', idx===i); });
  document.querySelectorAll('.nbtn').forEach(function(b,idx){ b.classList.toggle('active', idx===i); });
  if(i===2) initDist();
  if(i===3) initEggs();
  if(i===7) prevBurn();
}

// ---- NFT LEVELS ----
var nftIco  = ['','&#129360;','&#128154;','&#128142;','&#128302;','&#128293;','&#128081;'];
var nftCol  = ['','#aaa','#00ff88','#00d4ff','#9b59ff','#ff8c00','#ffd700'];
var nftNam  = ['','COMUN','INUSUAL','RARO','EPICO','LEGENDARIO','MITICO'];
var nftVals = [0,25,50,100,250,500,1000];

function showNFT(power, level) {
  var pool=5000, yld=2000;
  var pct = (power/pool*100).toFixed(2);
  var gain = (yld*power/pool).toFixed(2);
  var roi = (gain/power*100).toFixed(1);
  var el = document.getElementById('nft-out');
  el.style.display = 'block';
  document.getElementById('nft-out-inner').innerHTML =
    '<div style="display:flex;align-items:center;gap:16px;margin-bottom:12px">' +
    '<span style="font-size:2.5rem">' + nftIco[level] + '</span>' +
    '<div><div style="font-family:Orbitron,monospace;font-size:.6rem;color:var(--muted)">NIVEL ' + level + ' — ' + nftNam[level] + '</div>' +
    '<div style="font-family:Orbitron,monospace;font-size:1.8rem;font-weight:900;color:' + nftCol[level] + '">PODER ' + power + '</div></div></div>' +
    '<div class="rrow"><span style="color:var(--muted)">% del pool (5,000 total)</span><span class="v">' + pct + '%</span></div>' +
    '<div class="rrow"><span style="color:var(--muted)">Ganancia mensual (yield=$2,000)</span><span class="vg">$' + gain + '</span></div>' +
    '<div class="rrow"><span style="color:var(--muted)">ROI mensual</span><span class="vgold">' + roi + '%</span></div>' +
    '<div class="rrow"><span style="color:var(--muted)">ROI anual estimado</span><span class="vgold">' + (roi*12).toFixed(1) + '%</span></div>';
}

function calcYield() {
  var mp = parseInt(document.getElementById('s-pow').value);
  var tp = parseInt(document.getElementById('s-pool').value);
  var y  = parseFloat(document.getElementById('s-yield').value);
  var pct  = (mp/tp*100).toFixed(2);
  var gain = (y*mp/tp).toFixed(2);
  var roi  = (gain/mp*100).toFixed(2);
  document.getElementById('r-pow').textContent  = mp;
  document.getElementById('r-pool').textContent = tp.toLocaleString();
  document.getElementById('r-pct').textContent  = pct+'%';
  document.getElementById('r-yld').textContent  = '$'+y.toLocaleString();
  document.getElementById('r-gain').textContent = '$'+gain;
  document.getElementById('r-roi').textContent  = roi+'% mensual';
}
calcYield();

// ---- DISTRIBUTION ----
var dUsers = [
  {n:'ALPHA',p:1000,c:'#ffd700'},{n:'BETA',p:500,c:'#ff8c00'},{n:'GAMMA',p:500,c:'#9b59ff'},
  {n:'DELTA',p:250,c:'#00d4ff'},{n:'EPSILON',p:250,c:'#00ff88'},{n:'ZETA',p:100,c:'#aaa'},
  {n:'ETA',p:100,c:'#aaa'},{n:'THETA',p:100,c:'#aaa'},{n:'IOTA',p:50,c:'#aaa'}
];

function initDist() {
  var html = '';
  dUsers.forEach(function(u,i){
    html += '<div class="urow"><div class="uname">'+u.n+'</div>' +
      '<div class="upow" contenteditable="true" id="up'+i+'" onblur="calcDist()">'+u.p+'</div>' +
      '<div style="flex:1"><div class="ubar"><div class="ubarfill" id="ub'+i+'" style="width:0;background:'+u.c+'">—</div></div></div>' +
      '<div class="urew" id="ur'+i+'">—</div></div>';
  });
  document.getElementById('d-users').innerHTML = html;
  calcDist();
}

function calcDist() {
  var y = parseFloat(document.getElementById('d-yield').value)||5000;
  var powers = dUsers.map(function(u,i){
    var el = document.getElementById('up'+i);
    return el ? parseInt(el.textContent)||u.p : u.p;
  });
  var total = powers.reduce(function(a,b){return a+b;},0);
  var pp = y/total;
  document.getElementById('d-totpow').textContent = total.toLocaleString();
  document.getElementById('d-yld').textContent = '$'+y.toLocaleString();
  document.getElementById('d-ppow').textContent = '$'+pp.toFixed(4)+'/poder';
  powers.forEach(function(p,i){
    var pct = (p/total*100).toFixed(1);
    var rew = (y*p/total).toFixed(2);
    var fill = document.getElementById('ub'+i);
    var rEl  = document.getElementById('ur'+i);
    if(fill){ fill.style.width=pct+'%'; fill.textContent=pct+'%'; }
    if(rEl) rEl.textContent='$'+rew;
  });
}

// ---- EGGS ----
var eLevels = [
  {lv:1,pw:25, ico:'&#129360;',nm:'COMUN',     col:'#aaa',    val:25,   thr:30,   sh:0.40},
  {lv:2,pw:50, ico:'&#128154;',nm:'INUSUAL',   col:'#00ff88', val:50,   thr:62,   sh:0.25},
  {lv:3,pw:100,ico:'&#128142;',nm:'RARO',      col:'#00d4ff', val:100,  thr:125,  sh:0.15},
  {lv:4,pw:250,ico:'&#128302;',nm:'EPICO',     col:'#9b59ff', val:250,  thr:312,  sh:0.10},
  {lv:5,pw:500,ico:'&#128293;',nm:'LEGENDARIO',col:'#ff8c00', val:500,  thr:625,  sh:0.06},
  {lv:6,pw:1000,ico:'&#128081;',nm:'MITICO',   col:'#ffd700', val:1000, thr:1250, sh:0.04}
];
var ePools=[0,0,0,0,0,0,0], eOpened=0, eRecaud=0, eNFTs=0, eHist=[];

function initEggs() { renderEggs(); }

function renderEggs() {
  document.getElementById('e-count').textContent  = eOpened;
  document.getElementById('e-recaud').textContent = '$'+eRecaud.toFixed(0);
  document.getElementById('e-nfts').textContent   = '$'+eNFTs.toFixed(0);
  document.getElementById('e-gain').textContent   = '$'+(eRecaud-eNFTs).toFixed(2);
  var barsHtml = '';
  eLevels.forEach(function(l){
    var p = ePools[l.lv];
    var bw = Math.min(p/l.thr*100,100);
    var unlocked = p >= l.thr;
    var falta = Math.max(l.thr-p,0);
    var margen = ((l.thr-l.val)/l.thr*100).toFixed(0);
    var cyc = Math.ceil(l.thr/l.sh);
    barsHtml += '<div style="margin-bottom:10px;padding:10px;background:var(--bg);border:1px solid '+(unlocked?l.col:'var(--border)')+';">' +
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;flex-wrap:wrap;gap:4px">' +
      '<span style="font-family:Orbitron,monospace;font-size:.63rem;color:'+l.col+'">'+l.ico+' N'+l.lv+' '+l.nm+' PWR '+l.pw+'</span>' +
      '<span style="font-family:Share Tech Mono,monospace;font-size:.63rem;color:'+(unlocked?l.col:'var(--muted)')+'">'+
      (unlocked ? 'DISPONIBLE' : 'faltan $'+falta.toFixed(2))+'</span></div>' +
      '<div style="height:12px;background:#111;border:1px solid var(--border);overflow:hidden;margin-bottom:5px;position:relative">' +
      '<div style="height:100%;width:'+bw+'%;background:'+l.col+';opacity:.7;transition:width .3s"></div>' +
      '<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:Share Tech Mono,monospace;font-size:.58rem;color:#fff">$'+p.toFixed(2)+' / $'+l.thr+' ('+bw.toFixed(0)+'%)</div></div>' +
      '<div style="display:flex;gap:10px;font-family:Share Tech Mono,monospace;font-size:.58rem;color:var(--muted);flex-wrap:wrap">' +
      '<span>parte $1: <span style="color:'+l.col+'">$'+l.sh.toFixed(2)+'</span></span>' +
      '<span>umbral: <span style="color:var(--accent)">$'+l.thr+'</span></span>' +
      '<span>NFT: <span style="color:var(--red)">$'+l.val+'</span></span>' +
      '<span>margen: <span style="color:var(--green)">'+margen+'%</span></span>' +
      '<span>~'+cyc+' huevos/ciclo</span>' +
      '<span>entregados: <span style="color:'+l.col+'">'+( eHist.filter(function(h){return h.lv===l.lv;}).length )+'</span></span>' +
      '</div></div>';
  });
  if(eHist.length > 0){
    barsHtml += '<div style="font-family:Orbitron,monospace;font-size:.58rem;letter-spacing:2px;color:var(--muted);margin:10px 0 5px">HISTORIAL</div>';
    eHist.slice(-5).reverse().forEach(function(h){
      barsHtml += '<div style="font-family:Share Tech Mono,monospace;font-size:.67rem;padding:3px 8px;margin-bottom:2px;background:rgba(0,0,0,.3);border-left:2px solid '+h.col+';color:'+h.col+'">'+h.txt+'</div>';
    });
  }
  document.getElementById('e-bars').innerHTML = barsHtml;
}

function openEgg() {
  eRecaud += 1;
  eOpened++;
  eLevels.forEach(function(l){ ePools[l.lv] += l.sh; });
  var winner = null;
  for(var i=eLevels.length-1; i>=0; i--){
    if(ePools[eLevels[i].lv] >= eLevels[i].thr){ winner=eLevels[i]; break; }
  }
  var egg = document.getElementById('egg');
  var res = document.getElementById('e-result');
  if(winner){
    var mg = (winner.thr - winner.val).toFixed(2);
    ePools[winner.lv] -= winner.val;
    eNFTs += winner.val;
    eHist.push({lv:winner.lv,col:winner.col,txt:'#'+eOpened+' -> N'+winner.lv+' liberado | casa +$'+mg+' | pool N'+winner.lv+' $'+ePools[winner.lv].toFixed(2)});
    document.getElementById('e-icon').innerHTML = winner.ico;
    document.getElementById('e-lvl').textContent = 'NIVEL '+winner.lv+' — '+winner.nm;
    document.getElementById('e-pow').innerHTML = '<span style="color:'+winner.col+'">PODER '+winner.pw+'</span>';
    document.getElementById('e-desc').textContent = 'NFT acreditado. Casa gano $'+mg+'. Pool N'+winner.lv+' continua desde $'+ePools[winner.lv].toFixed(2);
    res.style.borderColor = winner.col;
    egg.style.animation='none'; egg.innerHTML=winner.ico;
    setTimeout(function(){ egg.innerHTML='&#129370;'; egg.style.animation='float 3s ease-in-out infinite'; }, 2500);
  } else {
    var best=eLevels[0], bestPct=0;
    eLevels.forEach(function(l){ var pc=ePools[l.lv]/l.thr; if(pc>bestPct){bestPct=pc;best=l;} });
    var flt = (best.thr - ePools[best.lv]).toFixed(2);
    eHist.push({lv:0,col:'var(--muted)',txt:'#'+eOpened+' -> sin premio | mas cerca: N'+best.lv+' falta $'+flt});
    document.getElementById('e-icon').innerHTML = '&#128168;';
    document.getElementById('e-lvl').textContent = 'SIN PREMIO';
    document.getElementById('e-pow').innerHTML = '<span style="color:var(--muted);font-size:.9rem">$1 distribuido en los 6 pools</span>';
    document.getElementById('e-desc').textContent = 'Mas cerca: N'+best.lv+' '+best.nm+' — falta $'+flt+' (pool actual $'+ePools[best.lv].toFixed(2)+')';
    res.style.borderColor='var(--border)';
    egg.style.animation='none'; egg.innerHTML='&#128168;';
    setTimeout(function(){ egg.innerHTML='&#129370;'; egg.style.animation='float 3s ease-in-out infinite'; }, 1200);
  }
  res.classList.add('show');
  renderEggs();
}

// ---- LOANS ----
var lVals = [0,25,50,100,250,500,1000];
function calcLoan() {
  var lv = parseInt(document.getElementById('l-nft').value);
  var mo = parseInt(document.getElementById('l-months').value);
  var val = lVals[lv];
  var loan = Math.floor(val*0.65);
  var intM = parseFloat((loan*0.05).toFixed(2));
  var tot  = parseFloat((loan + intM*mo).toFixed(2));
  var gain = parseFloat((intM*mo).toFixed(2));
  var def  = val - loan;
  document.getElementById('l-val').textContent  = '$'+val;
  document.getElementById('l-ltv').textContent  = '65% del valor';
  document.getElementById('l-loan').textContent = '$'+loan+' USDT';
  document.getElementById('l-int').textContent  = '$'+intM+'/mes';
  document.getElementById('l-tot').textContent  = '$'+tot+' ('+mo+' mes'+(mo>1?'es':'')+')';
  document.getElementById('l-gain').textContent = '$'+gain+' USDT';
  document.getElementById('l-def').textContent  = 'NFT $'+val+' — margen +$'+def;
}

// ---- BURN FUND ----
var bRates  = [0,0.70,0.70,0.72,0.74,0.75,0.75];
var bFund   = 2500;
var bCount  = 0;
var bPaid   = 0;
var bRet    = 0;
var bLog    = [];
var bColors = ['','#aaa','#00ff88','#00d4ff','#9b59ff','#ff8c00','#ffd700'];

function updateBurnUI() {
  var el = document.getElementById('bf-display');
  el.textContent = '$'+bFund.toFixed(2);
  el.style.color = bFund < 500 ? 'var(--red)' : bFund < 1000 ? 'var(--gold)' : 'var(--orange)';
  document.getElementById('bf-count').textContent = bCount;
  document.getElementById('bf-paid').textContent  = '$'+bPaid.toFixed(2);
  document.getElementById('bf-ret').textContent   = '$'+bRet.toFixed(2);
}

function prevBurn() {
  var lv  = parseInt(document.getElementById('b-nft').value);
  var val = nftVals[lv];
  var payout = parseFloat((val*bRates[lv]).toFixed(2));
  var kept   = parseFloat((val*(1-bRates[lv])).toFixed(2));
  var ok = bFund >= payout;
  var col = bColors[lv];
  document.getElementById('b-prev').innerHTML =
    '<div style="margin-bottom:8px;font-family:Orbitron,monospace;font-size:.62rem;color:'+col+';letter-spacing:2px">N'+lv+' — PREVIEW QUEMA</div>' +
    '<div style="display:flex;flex-direction:column;gap:5px">' +
    '<div style="display:flex;justify-content:space-between"><span style="color:var(--muted)">Valor nominal</span><span>$'+val+'</span></div>' +
    '<div style="display:flex;justify-content:space-between"><span style="color:var(--muted)">Tasa quema</span><span>'+(bRates[lv]*100).toFixed(0)+'%</span></div>' +
    '<div style="display:flex;justify-content:space-between"><span style="color:var(--muted)">Recibes tu</span><span style="color:var(--green);font-size:1.1rem;font-weight:bold">$'+payout+'</span></div>' +
    '<div style="display:flex;justify-content:space-between"><span style="color:var(--muted)">Queda en fondo</span><span style="color:var(--orange)">$'+kept+'</span></div>' +
    '<div style="display:flex;justify-content:space-between;margin-top:4px;padding-top:6px;border-top:1px solid var(--border)">' +
    '<span style="color:var(--muted)">Saldo fondo</span><span style="color:'+(ok?'var(--green)':'var(--red)')+';font-weight:bold">$'+bFund.toFixed(2)+'</span></div>' +
    '<div style="text-align:center;margin-top:6px;padding:6px;border:1px solid '+(ok?'var(--green)':'var(--red)')+';color:'+(ok?'var(--green)':'var(--red)')+';font-family:Orbitron,monospace;font-size:.62rem;letter-spacing:2px">' +
    (ok ? 'QUEMA DISPONIBLE' : 'FONDOS INSUFICIENTES — falta $'+(payout-bFund).toFixed(2)) + '</div></div>';
  var btn = document.getElementById('b-btn');
  btn.disabled = !ok;
}

function doBurn() {
  var lv  = parseInt(document.getElementById('b-nft').value);
  var val = nftVals[lv];
  var payout = parseFloat((val*bRates[lv]).toFixed(2));
  var kept   = parseFloat((val*(1-bRates[lv])).toFixed(2));
  if(bFund < payout){ return; }
  bFund -= payout;
  bFund += kept;
  bCount++; bPaid += payout; bRet += kept;
  bLog.push({lv:lv,col:bColors[lv],pay:payout,kept:kept,after:bFund});
  updateBurnUI(); prevBurn(); renderBurnLog();
}

function addBurn(amt) {
  bFund += amt;
  bLog.push({recharge:true,amt:amt,after:bFund});
  updateBurnUI(); prevBurn(); renderBurnLog();
}

function renderBurnLog() {
  if(!bLog.length){ document.getElementById('b-hist').innerHTML=''; return; }
  var html = '<div style="font-family:Orbitron,monospace;font-size:.58rem;letter-spacing:2px;color:var(--muted);margin-bottom:6px">HISTORIAL</div>';
  bLog.slice(-8).reverse().forEach(function(h){
    if(h.recharge){
      html += '<div style="font-family:Share Tech Mono,monospace;font-size:.68rem;padding:4px 8px;margin-bottom:2px;background:rgba(0,255,136,.05);border-left:2px solid var(--green);color:var(--green)">Recarga +$'+h.amt+' — fondo: $'+h.after.toFixed(2)+'</div>';
    } else {
      html += '<div style="font-family:Share Tech Mono,monospace;font-size:.68rem;padding:4px 8px;margin-bottom:2px;background:rgba(0,0,0,.2);border-left:2px solid '+h.col+';color:'+h.col+'">N'+h.lv+' quemado — usuario recibio <span style="color:var(--green)">$'+h.pay+'</span> — fondo retuvo <span style="color:var(--orange)">$'+h.kept+'</span> — saldo: <span style="color:var(--accent)">$'+h.after.toFixed(2)+'</span></div>';
    }
  });
  document.getElementById('b-hist').innerHTML = html;
}

// ---- TOKENOMICS ----
function calcTok() {
  var cap = parseFloat(document.getElementById('t-cap').value);
  var pct = parseFloat(document.getElementById('t-pct').value);
  var gross = cap*pct/100;
  var fee   = gross*0.2;
  var dist  = gross-fee;
  var apy   = (dist/cap*100).toFixed(2);
  document.getElementById('t-rcap').textContent  = '$'+cap.toLocaleString();
  document.getElementById('t-rpct').textContent  = pct+'%';
  document.getElementById('t-rgross').textContent = '$'+gross.toFixed(2);
  document.getElementById('t-rfee').textContent  = '$'+fee.toFixed(2);
  document.getElementById('t-rdist').textContent = '$'+dist.toFixed(2);
  document.getElementById('t-rapy').textContent  = apy+'%';
  document.getElementById('t-res').style.display = 'block';
}

// ---- REFERIDOS ----
var refRates = [0, 0.05, 0.02, 0.01];
var refCap   = 30; // max comision por transaccion N6
var refNodes = {1:0, 2:0, 3:0};
var refNames = ['','ALFA','BETA','GAMMA','DELTA','EPSILON','ZETA','ETA','THETA','IOTA','KAPPA',
                'LAMBDA','MU','NU','XI','OMICRON','PI','RHO','SIGMA','TAU','UPSILON'];

function calcRef() {
  var price = parseFloat(document.getElementById('ref-nft').value);
  var n1 = parseInt(document.getElementById('ref-n1').value)||0;
  var n2 = parseInt(document.getElementById('ref-n2').value)||0;
  var n3 = parseInt(document.getElementById('ref-n3').value)||0;
  var c1 = Math.min(price*0.05, refCap);
  var c2 = Math.min(price*0.02, refCap);
  var c3 = Math.min(price*0.01, refCap);
  var g1 = c1*n1, g2 = c2*n2, g3 = c3*n3;
  var tot = g1+g2+g3;
  var totalComPerBuy = Math.min(price*0.05,refCap)+Math.min(price*0.02,refCap)+Math.min(price*0.01,refCap);
  var toFund = price - totalComPerBuy;
  document.getElementById('rc-price').textContent = '$'+price;
  document.getElementById('rc-c1').textContent    = '$'+c1.toFixed(2);
  document.getElementById('rc-n1').textContent    = n1+' personas';
  document.getElementById('rc-g1').textContent    = '$'+g1.toFixed(2);
  document.getElementById('rc-c2').textContent    = '$'+c2.toFixed(2);
  document.getElementById('rc-n2').textContent    = n2+' personas';
  document.getElementById('rc-g2').textContent    = '$'+g2.toFixed(2);
  document.getElementById('rc-c3').textContent    = '$'+c3.toFixed(2);
  document.getElementById('rc-n3').textContent    = n3+' personas';
  document.getElementById('rc-g3').textContent    = '$'+g3.toFixed(2);
  document.getElementById('rc-tot').textContent   = '$'+tot.toFixed(2);
  document.getElementById('rc-fund').textContent  = '$'+toFund.toFixed(2)+' de $'+price;
  document.getElementById('rc-pct').textContent   = (toFund/price*100).toFixed(1)+'% al fondo';
}
calcRef();

function addRefNode(level) {
  refNodes[level]++;
  renderRefTree();
}

function resetRef() {
  refNodes = {1:0,2:0,3:0};
  renderRefTree();
}

function renderRefTree() {
  var price = parseFloat(document.getElementById('ref-tree-nft').value);
  var n1=refNodes[1], n2=refNodes[2], n3=refNodes[3];
  var total = n1+n2+n3;
  var levColors = ['','var(--green)','var(--accent)','var(--purple)'];
  var levPcts   = ['','5%','2%','1%'];
  var levRates  = [0,0.05,0.02,0.01];
  var html = '';

  // YOU node
  html += '<div style="display:flex;align-items:center;gap:8px;margin-bottom:6px;padding:10px;background:rgba(255,215,0,.08);border:1px solid var(--gold)">' +
    '<span style="font-size:1.5rem">&#128081;</span>' +
    '<div><div style="font-family:Orbitron,monospace;font-size:.65rem;color:var(--gold)">TU — REFERIDOR PRINCIPAL</div>' +
    '<div style="font-size:.7rem;color:var(--muted)">Red total: '+total+' personas</div></div></div>';

  [1,2,3].forEach(function(lv) {
    var count = refNodes[lv];
    if(count === 0) return;
    var com = Math.min(price*levRates[lv], refCap);
    var totalCom = com*count;
    var indent = (lv-1)*20;
    html += '<div style="margin-left:'+indent+'px;margin-bottom:4px">';
    for(var i=0; i<Math.min(count,8); i++) {
      var name = refNames[(lv*7+i)%refNames.length] || ('USER'+(lv*10+i));
      html += '<div style="display:flex;align-items:center;gap:8px;padding:6px 10px;margin-bottom:3px;background:rgba(0,0,0,.2);border-left:2px solid '+levColors[lv]+'">' +
        '<span style="font-size:.9rem">&#128100;</span>' +
        '<span style="color:'+levColors[lv]+';font-family:Orbitron,monospace;font-size:.6rem">'+name+'</span>' +
        '<span style="color:var(--muted);font-size:.62rem">nivel '+lv+'</span>' +
        '<span style="margin-left:auto;color:var(--green);font-size:.7rem">+$'+com.toFixed(2)+' para ti ('+levPcts[lv]+')</span></div>';
    }
    if(count > 8) {
      html += '<div style="padding:4px 10px;color:var(--muted);font-size:.65rem;margin-left:10px">...y '+(count-8)+' mas en nivel '+lv+'</div>';
    }
    html += '</div>';
  });

  if(total === 0) {
    html += '<div style="color:var(--muted);padding:20px;text-align:center;font-size:.8rem">Agrega referidos usando los botones de arriba</div>';
  }

  document.getElementById('ref-tree').innerHTML = html;

  if(total > 0) {
    var c1=Math.min(price*0.05,refCap)*n1;
    var c2=Math.min(price*0.02,refCap)*n2;
    var c3=Math.min(price*0.01,refCap)*n3;
    var tot=c1+c2+c3;
    document.getElementById('rtt-count').textContent = total+' personas en tu red';
    document.getElementById('rtt-c1').textContent    = '$'+c1.toFixed(2)+' ('+n1+' x $'+Math.min(price*0.05,refCap).toFixed(2)+')';
    document.getElementById('rtt-c2').textContent    = '$'+c2.toFixed(2)+' ('+n2+' x $'+Math.min(price*0.02,refCap).toFixed(2)+')';
    document.getElementById('rtt-c3').textContent    = '$'+c3.toFixed(2)+' ('+n3+' x $'+Math.min(price*0.01,refCap).toFixed(2)+')';
    document.getElementById('rtt-tot').textContent   = '$'+tot.toFixed(2);
    document.getElementById('ref-tree-total').style.display = 'block';
  } else {
    document.getElementById('ref-tree-total').style.display = 'none';
  }
}
renderRefTree();


// ---- DASHBOARD HISTORICO ----
var dhDeposits  = [];
var dhPoolState = {n1:20,n2:15,n3:10,n4:5,n5:3,n6:1};
var nftPrices   = [0,25,50,100,250,500,1000];
var nftPowers   = [0,25,50,100,250,500,1000];

function getPoolStats() {
  var n = [0, parseInt(document.getElementById('pool-n1').value)||0,
               parseInt(document.getElementById('pool-n2').value)||0,
               parseInt(document.getElementById('pool-n3').value)||0,
               parseInt(document.getElementById('pool-n4').value)||0,
               parseInt(document.getElementById('pool-n5').value)||0,
               parseInt(document.getElementById('pool-n6').value)||0];
  var totalNFTs=0, totalPower=0, totalNominal=0;
  for(var i=1;i<=6;i++){
    totalNFTs    += n[i];
    totalPower   += n[i]*nftPowers[i];
    totalNominal += n[i]*nftPrices[i];
  }
  return {nfts:totalNFTs, power:totalPower, nominal:totalNominal, byLevel:n};
}

function updatePool() {
  var s = getPoolStats();
  var dep = 350;
  var rentMedia = s.nominal > 0 ? (dep/s.nominal*100).toFixed(2) : '0.00';
  document.getElementById('ps-nfts').textContent    = s.nfts;
  document.getElementById('ps-power').textContent   = s.power.toLocaleString();
  document.getElementById('ps-nominal').textContent = '$'+s.nominal.toLocaleString();
  document.getElementById('ps-capital').textContent = '$'+s.nominal.toLocaleString();
  document.getElementById('ps-example').textContent = '= '+rentMedia+'% rent. media';
  updateDashHeader(s);
}

function updateDashHeader(s) {
  document.getElementById('dh-stakers').textContent = s.nfts;
  document.getElementById('dh-nfts').textContent    = s.nfts;
  document.getElementById('dh-power').textContent   = s.power.toLocaleString();
  document.getElementById('dh-capital').textContent = '$'+s.nominal.toLocaleString();
  if(dhDeposits.length > 0) {
    var last = dhDeposits[dhDeposits.length-1];
    document.getElementById('dh-lastdep').textContent = '$'+last.dep;
    var avg = dhDeposits.reduce(function(a,b){return a+b.pct;},0)/dhDeposits.length;
    var avgEl = document.getElementById('dh-avg');
    avgEl.textContent = avg.toFixed(2)+'%';
    avgEl.style.color = avg > 3 ? 'var(--green)' : avg > 0 ? 'var(--gold)' : 'var(--red)';
  }
}

function addDeposit() {
  var mes    = document.getElementById('dh-mes').value;
  var dep    = parseFloat(document.getElementById('dh-dep').value)||0;
  var capMes = parseFloat(document.getElementById('dh-cap-mes').value)||0;
  var s      = getPoolStats();
  var pct    = capMes > 0 ? parseFloat((dep/capMes*100).toFixed(2)) : 0;
  var rentMedia = s.nominal > 0 ? parseFloat((dep/s.nominal*100).toFixed(2)) : 0;

  dhDeposits.push({
    mes: mes, dep: dep, cap: capMes, pct: pct,
    nfts: s.nfts, power: s.power, nominal: s.nominal, rentMedia: rentMedia
  });

  renderDashTable();
  renderDashChart();
  updatePool();
}

function renderDashTable() {
  var tbody = document.getElementById('dh-table-body');
  if(dhDeposits.length === 0){
    tbody.innerHTML = '<tr><td colspan="8" style="text-align:center;color:var(--muted);padding:20px">Agrega el primer deposito mensual</td></tr>';
    return;
  }
  var html = '';
  dhDeposits.slice().reverse().forEach(function(d, i) {
    var pctCol = d.pct > 5 ? 'var(--green)' : d.pct > 2 ? 'var(--gold)' : d.pct > 0 ? 'var(--orange)' : 'var(--red)';
    var isLast = i === 0;
    html += '<tr style="'+(isLast?'background:rgba(255,215,0,.04)':'')+'">' +
      '<td style="color:'+(isLast?'var(--gold)':'var(--text)')+'">'+d.mes+(isLast?' &#9654;':'')+' </td>' +
      '<td style="color:var(--accent)">$'+d.cap.toLocaleString()+'</td>' +
      '<td style="color:var(--green);font-weight:bold">$'+d.dep.toLocaleString()+'</td>' +
      '<td style="color:'+pctCol+';font-weight:bold">'+d.pct+'%</td>' +
      '<td>'+d.nfts+'</td>' +
      '<td style="color:var(--gold)">'+d.power.toLocaleString()+'</td>' +
      '<td>$'+d.nominal.toLocaleString()+'</td>' +
      '<td style="color:var(--green)">'+d.rentMedia+'%</td>' +
      '</tr>';
  });
  tbody.innerHTML = html;
}

function renderDashChart() {
  if(dhDeposits.length === 0) return;
  var maxPct = Math.max.apply(null, dhDeposits.map(function(d){return d.pct;}));
  if(maxPct === 0) maxPct = 1;
  var chartHtml = '', labelsHtml = '';
  var w = Math.max(30, Math.floor(560/dhDeposits.length)-6);

  dhDeposits.forEach(function(d) {
    var h = Math.max(4, Math.round(d.pct/maxPct*100));
    var col = d.pct > 5 ? 'var(--green)' : d.pct > 2 ? 'var(--gold)' : d.pct > 0 ? 'var(--orange)' : 'var(--red)';
    chartHtml += '<div style="display:flex;flex-direction:column;align-items:center;gap:3px;flex:1;min-width:'+w+'px">' +
      '<div style="font-family:Share Tech Mono,monospace;font-size:.55rem;color:'+col+'">'+d.pct+'%</div>' +
      '<div style="width:100%;height:'+h+'px;background:'+col+';opacity:.8;min-height:4px"></div></div>';
    var shortMes = d.mes.split(' ')[0].substring(0,3);
    labelsHtml += '<div style="flex:1;min-width:'+w+'px;text-align:center;font-size:.55rem">'+shortMes+'</div>';
  });

  document.getElementById('dh-chart').innerHTML = chartHtml;
  document.getElementById('dh-chart-labels').innerHTML = labelsHtml;
  document.getElementById('dh-chart-wrap').style.display = 'block';
}

// init pool on load
updatePool();

</script>
</body>
</html>
